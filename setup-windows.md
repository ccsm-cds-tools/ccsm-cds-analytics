# Windows Setup

The CCSM CDS Analytics project is an R project which uses Quarto to run and publish reports.

You will need the following to be able to run and use this project on Windows systems:

1.  [Install R](https://cran.r-project.org/bin/windows/) - You should use R version 4.4 or higher.
2.  [Install RStudio](https://posit.co/download/rstudio-desktop/) - This IDE will allow you to interactively run the analytics scripts and generate reports.
3.  Follow the [Quarto "Get Started" instructions](https://quarto.org/docs/get-started/) to install Quarto on your system. This is the publishing system which creates the reports.
4.  Open RStudio: go to "File \> Open Project...", and navigate to the folder of the CCSM CDS Analytics project. You should see a `ccsm-cds-analytics.Rproj` file in this folder -- if you do, that's the right folder. Then run `renv::restore()` in the R Console to download and install all the R package dependencies.

At this point you should be ready to run the Quarto notebook file to produce a report based on log data. The [CCSM CDS Dashboard pilot](https://github.com/ccsm-cds-tools/ccsm-cds-dashboard/tree/pilot) can be configured to save patient data elements to a log file using the [CDS Dashboard Logger](https://github.com/ccsm-cds-tools/cds-dashboard-logger) service. The CCSM CDS Dashboard will log recommendations generated for each patient viewed in the Dashboard, and will also include additional data elements to be used in this CCSM CDS Analytics project.

To run the analytics and produce the report, you will need to copy the CCSM CDS Dashboard log files into the project.

In the CCSM CDS Analytics project directory, there should be a directory called `data` and inside that a directory called `logfiles`. Copy individual log files from the CDS Dashboard Logger into this directory. The logger files are stored inside the `logfiles` directory where the logger is running, and are named `ccsmcds-2025-MM-YY.log` or `ccsmcds-2025-MM-YY.log.gz` which is a compressed `gzip` version of a logfile. You should not copy the `error.log` file from the logfiles directory.

The analytics scripts will read all logfiles from the `data/logfiles` directory. You do not have to decompress any `.log.gz` files - the script should import both `.log` and `.log.gz` files.

## Running the report

Currently there is one `.qmd` Quarto notebook file to generate. Open `index.qmd`. If everything has been installed, you should be able to click the "Render" button at the top of the RStudio IDE. It will read in the log files and generate the HTML file containing the analytics output. This should open automatically in the "Viewer" tab of the "Files, Plots, Packages, Help" pane in the RStudio IDE. The generated report HTML file and images should be exported automatically to the `public` directory at the top level of the project. Future updates to the project will add support for additional output formats, such as PDF or Word.

If there are any errors encountered, those will be displayed in the "Background Jobs" tab of the "Console" pane.

## Privacy and Security

This project is designed to work with sensitive patient data, including Protected Health Information (PHI) and Personally Identifiable Information (PII) recorded from the Cervical Cancer Screening and Management (CCSM) Clinical Decision Support (CDS) project. You should install and run this project **only** on systems which have been authorized for the storage and handling of this data. While the reports generated by this project are intended to generate and publish only aggregated data, without including individual PHI/PII information or revealing individual identities, the analytics environment and process of generating the report can produce intermediate files which do contain sensitive information.

Individuals not authorized to view or handle this information should not have access to the system where this project is installed once sensitive log files have been imported.
